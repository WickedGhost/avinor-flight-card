try{window.customCards=window.customCards||[];window.customCards.some(t=>"avinor-flight-card"===t.type)||window.customCards.push({type:"avinor-flight-card",name:"Avinor Flight Card",description:"Table of Avinor flights from sensor attributes (custom component).",preview:!0,documentationURL:"https://github.com/WickedGhost/avinor_flight_data",version:"1.0.5"})}catch(t){}class t extends HTMLElement{constructor(){super(),this._config=null,this._hass=null,this._excludedColumns=new Set,this._card=null,this._content=null}static getStubConfig(t){if(t&&t.states){const e=Object.keys(t.states).find(t=>t.startsWith("sensor.avinor_"));if(e)return{entity:e,title:"Avinor Flight Data"}}return{entity:"",title:"Avinor Flight Data",exclude_columns:[]}}static getConfigElement(){return document.createElement("avinor-flight-card-editor")}setConfig(t){if(!t||!t.entity)throw new Error("Please define entity");this._config={title:"Avinor Flight Data",exclude_columns:[],...t},this._excludedColumns=this._normalizeExcludedColumns(this._config.exclude_columns),this._card||(this._card=document.createElement("ha-card"),this._content=document.createElement("div"),this._content.style.padding="16px",this._card.appendChild(this._content),this.appendChild(this._card)),this._card.header=this._config.title||"Avinor Flight Data",this._hass&&(this.hass=this._hass)}set hass(t){if(this._hass=t,!this._config||!this._content)return;this._excludedColumns=this._normalizeExcludedColumns(this._config.exclude_columns);const e=this._config.entity,n=t&&t.states?t.states[e]:void 0;if(!n)return void(this._content.innerHTML=`<div>Entity ${e} not found</div>`);const i=n.attributes||{},o=Array.isArray(i.flights)?i.flights:[],r=i.airport||"",a=i.direction||"",s=i.last_update||"",l="A"===a,d=t=>!!this._excludedColumns.has(t)||!(!l||"check_in"!==t&&"gate"!==t),c=`Airport: ${r} • Direction: ${a} • Flights: ${o.length} • Updated: ${s}`,h=o.map(t=>{const e={S:"Schengen",D:"Domestic",I:"International"}[t.dom_int]||t.dom_int||"",n=this._getAirportName(t.airport),i=this._getStatusText(t.status_code),o=this._extractTime(t.schedule_time);return`\n        <tr>\n          ${d("flight")?"":`<td style="padding: 8px;">${this._e(t.flightId)}</td>`}\n          ${d("type")?"":`<td style="padding: 8px;">${this._e(e)}</td>`}\n          ${d("scheduled")?"":`<td style="padding: 8px;">${this._e(o)}</td>`}\n          ${d("airport")?"":`<td style="padding: 8px;">${this._e(n)}</td>`}\n          ${d("check_in")?"":`<td style="padding: 8px;">${this._e(t.check_in)}</td>`}\n          ${d("gate")?"":`<td style="padding: 8px;">${this._e(t.gate)}</td>`}\n          ${d("status")?"":`<td style="padding: 8px;">${this._e(i)}</td>`}\n        </tr>\n      `}).join("");this._content.innerHTML=`\n      <div style="margin-bottom:8px; font-size: 0.9em; color: var(--secondary-text-color);">${c}</div>\n      <div style="overflow:auto;">\n        <table style="width:100%; border-collapse: collapse;">\n          <thead>\n            <tr>\n              ${d("flight")?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Flight</th>'}\n              ${d("type")?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Type</th>'}\n              ${d("scheduled")?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Scheduled</th>'}\n              ${d("airport")?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Airport</th>'}\n              ${d("check_in")?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Check-in</th>'}\n              ${d("gate")?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Gate</th>'}\n              ${d("status")?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Status</th>'}\n            </tr>\n          </thead>\n          <tbody>\n            ${h}\n          </tbody>\n        </table>\n      </div>\n      <div style="margin-top:8px; font-size: 0.8em; color: var(--secondary-text-color);">\n        Flydata fra <a href="https://www.avinor.no/" target="_blank" rel="noreferrer">Avinor</a>\n      </div>\n    `}_e(t){if(null==t)return"";return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}_normalizeExcludedColumns(t){const e=new Set,n=Array.isArray(t)?t:"string"==typeof t?t.split(","):[];for(const t of n){if(null==t)continue;const n=String(t).trim().toLowerCase().replace(/\s+/g,"_").replace(/-/g,"_");n&&e.add(n)}return e}_getAirportName(t){if(!t)return"";return{OSL:"Oslo",BGO:"Bergen",TRD:"Trondheim",SVG:"Stavanger",BOO:"Bodø",TOS:"Tromsø",AES:"Ålesund",KRS:"Kristiansand",HAU:"Haugesund",MOL:"Molde",EVE:"Harstad/Narvik",KKN:"Kirkenes",LKL:"Lakselv",ALF:"Alta",HFT:"Hammerfest",VDS:"Vadsø",BDU:"Bardufoss",SSJ:"Sandnessjøen",MJF:"Mosjøen",RVK:"Rørvik",BNN:"Brønnøysund",SKN:"Stokmarknes",LYR:"Longyearbyen",ANX:"Andøya",FDE:"Førde",SOG:"Sogndal",FRO:"Florø",NTB:"Notodden",SKE:"Skien",TRF:"Sandefjord",RRS:"Røros",OLA:"Ørland",HOV:"Ørsta-Volda",SDN:"Sandane",CPH:"Copenhagen",ARN:"Stockholm",HEL:"Helsinki",LHR:"London",AMS:"Amsterdam",CDG:"Paris",FRA:"Frankfurt",MUC:"Munich",ZRH:"Zurich",BCN:"Barcelona",MAD:"Madrid",FCO:"Rome",IST:"Istanbul",DXB:"Dubai",DOH:"Doha",JFK:"New York",EWR:"Newark",ORD:"Chicago",LAX:"Los Angeles",MIA:"Miami",BKK:"Bangkok",SIN:"Singapore",HKG:"Hong Kong",NRT:"Tokyo",ICN:"Seoul",KEF:"Reykjavik",ATH:"Athens",DUB:"Dublin",BRU:"Brussels",VIE:"Vienna",PRG:"Prague",WAW:"Warsaw",LIS:"Lisbon",MAN:"Manchester",EDI:"Edinburgh",GLA:"Glasgow",NCE:"Nice",LYS:"Lyon",TXL:"Berlin",HAM:"Hamburg",DUS:"Düsseldorf",BER:"Berlin",CGN:"Cologne",STR:"Stuttgart"}[t]||t}_getStatusText(t){if(!t)return"";return{E:"New Info",A:"Arrived",C:"Cancelled",D:"Departed",N:"New Time",BRD:"Boarding",GCL:"Gate Closed",GTD:"Gate Open",DLY:"Delayed",EXP:"Expected",FIR:"Final Call",WIL:"Wait in Lounge",DEP:"Departed",ARR:"Arrived",CNX:"Cancelled",AIR:"Airborne",LND:"Landed",CKI:"Check-in",CKC:"Check-in Closed"}[t]||t}_extractTime(t){if(!t)return"";try{const e=new Date(t+(t.includes("Z")?"":"Z"));if(isNaN(e.getTime()))return t;const n=e.getHours().toString().padStart(2,"0");return`${n}:${e.getMinutes().toString().padStart(2,"0")}`}catch(e){return t}}getCardSize(){return 4}}customElements.define("avinor-flight-card",t);class e extends HTMLElement{constructor(){super(),this._config=null,this._hass=null}setConfig(t){this._config={title:"",exclude_columns:[],...t},this.render()}configChanged(t){const e=new Event("config-changed",{bubbles:!0,composed:!0});e.detail={config:t},this.dispatchEvent(e)}render(){if(!this._config)return;const t=(this._hass?Object.keys(this._hass.states).filter(t=>t.startsWith("sensor.avinor_")).sort():[]).map(t=>{const e=this._hass.states[t];return`<option value="${t}">${t} - ${e.attributes.airport||""} ${"D"===(e.attributes.direction||"")?"Departures":"Arrivals"}</option>`}).join(""),e=new Set(Array.isArray(this._config.exclude_columns)?this._config.exclude_columns.map(t=>String(t).toLowerCase().replace(/\s+/g,"_").replace(/-/g,"_")):[]),n=[{key:"flight",label:"Flight"},{key:"type",label:"Type"},{key:"scheduled",label:"Scheduled"},{key:"airport",label:"Airport"},{key:"check_in",label:"Check-in"},{key:"gate",label:"Gate"},{key:"status",label:"Status"}].map(({key:t,label:n})=>`\n      <label style="display:flex; align-items:center; gap:8px; margin: 6px 0;">\n        <input type="checkbox" data-col="${t}" ${e.has(t)?"checked":""} />\n        <span>${n}</span>\n      </label>\n    `).join("");this.innerHTML=`\n      <div style="padding: 16px;">\n        <div style="margin-bottom: 16px; position: relative;">\n          <label style="display: block; margin-bottom: 8px; font-weight: 500;">\n            Entity (required)\n          </label>\n          <select\n            id="entity"\n            style="width: 100%; padding: 8px; border: 1px solid var(--divider-color); border-radius: 4px; background: var(--card-background-color); color: var(--primary-text-color);"\n          >\n            <option value="">-- Select an entity --</option>\n            ${t}\n          </select>\n          <div style="margin-top: 4px; font-size: 0.9em; color: var(--secondary-text-color);">\n            Select an Avinor flight sensor entity\n          </div>\n        </div>\n\n        <div style="margin-bottom: 16px;">\n          <label style="display: block; margin-bottom: 8px; font-weight: 500;">\n            Title (optional)\n          </label>\n          <input\n            type="text"\n            id="title"\n            value="${this._config.title||""}"\n            placeholder="Avganger OSL"\n            style="width: 100%; padding: 8px; border: 1px solid var(--divider-color); border-radius: 4px; background: var(--card-background-color); color: var(--primary-text-color);"\n          />\n          <div style="margin-top: 4px; font-size: 0.9em; color: var(--secondary-text-color);">\n            Card title (leave empty for default)\n          </div>\n        </div>\n\n        <div style="margin-bottom: 16px;">\n          <label style="display: block; margin-bottom: 8px; font-weight: 500;">\n            Exclude columns (optional)\n          </label>\n          <div style="padding: 8px; border: 1px solid var(--divider-color); border-radius: 4px;">\n            ${n}\n          </div>\n          <div style="margin-top: 4px; font-size: 0.9em; color: var(--secondary-text-color);">\n            Check the columns you want to hide\n          </div>\n        </div>\n      </div>\n    `;const i=this.querySelector("#entity");this._config.entity&&(i.value=this._config.entity),i.addEventListener("change",t=>{this._config={...this._config,entity:t.target.value},this.configChanged(this._config)}),this.querySelector("#title").addEventListener("input",t=>{this._config={...this._config,title:t.target.value},this.configChanged(this._config)}),this.querySelectorAll('input[type="checkbox"][data-col]').forEach(t=>{t.addEventListener("change",()=>{const t=[];this.querySelectorAll('input[type="checkbox"][data-col]').forEach(e=>{e.checked&&t.push(e.getAttribute("data-col"))}),this._config={...this._config,exclude_columns:t},this.configChanged(this._config)})})}set hass(t){this._hass=t,this._config&&this.render()}}customElements.define("avinor-flight-card-editor",e),console.info("%c AVINOR-FLIGHT-CARD %c Registered successfully with visual editor ","background-color: #41bdf5; color: #fff; font-weight: bold;","background-color: #333; color: #fff;");
