try{window.customCards=window.customCards||[];window.customCards.some(t=>"avinor-flight-card"===t.type)||window.customCards.push({type:"avinor-flight-card",name:"Avinor Flight Card",description:"Table of Avinor flights from sensor attributes (custom component).",preview:!0,documentationURL:"https://github.com/WickedGhost/avinor_flight_data",version:"0.0.0-dev"})}catch(t){}class t extends HTMLElement{static getStubConfig(t){if(t&&t.states){const e=Object.keys(t.states).find(t=>t.startsWith("sensor.avinor_"));if(e)return{entity:e,title:"Avinor Flight Data"}}return{entity:"",title:"Avinor Flight Data"}}static getConfigElement(){return document.createElement("avinor-flight-card-editor")}setConfig(t){if(!t.entity)throw new Error("Please define entity");this._config=t,this._content=document.createElement("div"),this._content.style.padding="16px";const e=document.createElement("ha-card");t.title?e.header=t.title:e.header="Avinor Flight Data",e.appendChild(this._content),this.appendChild(e)}set hass(t){if(this._hass=t,!this._config)return;const e=this._config.entity,n=t.states[e];if(!n)return void(this._content.innerHTML=`<div>Entity ${e} not found</div>`);const i=n.attributes||{},r=Array.isArray(i.flights)?i.flights:[],o=i.airport||"",a=i.direction||"",d=i.last_update||"",s="A"===a,l=`Airport: ${o} • Direction: ${a} • Flights: ${r.length} • Updated: ${d}`,c=r.map(t=>{const e={S:"Schengen",D:"Domestic",I:"International"}[t.dom_int]||t.dom_int||"",n=this._getAirportName(t.airport),i=this._getStatusText(t.status_code),r=this._extractTime(t.schedule_time);return`\n        <tr>\n          <td style="padding: 8px;">${this._e(t.flightId)}</td>\n          <td style="padding: 8px;">${this._e(e)}</td>\n          <td style="padding: 8px;">${this._e(r)}</td>\n          <td style="padding: 8px;">${this._e(n)}</td>\n          ${s?"":`<td style="padding: 8px;">${this._e(t.check_in)}</td>`}\n          ${s?"":`<td style="padding: 8px;">${this._e(t.gate)}</td>`}\n          <td style="padding: 8px;">${this._e(i)}</td>\n        </tr>\n      `}).join("");this._content.innerHTML=`\n      <div style="margin-bottom:8px; font-size: 0.9em; color: var(--secondary-text-color);">${l}</div>\n      <div style="overflow:auto;">\n        <table style="width:100%; border-collapse: collapse;">\n          <thead>\n            <tr>\n              <th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Flight</th>\n              <th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Type</th>\n              <th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Scheduled</th>\n              <th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Airport</th>\n              ${s?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Check-in</th>'}\n              ${s?"":'<th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Gate</th>'}\n              <th style="text-align:left; padding: 8px; border-bottom: 1px solid var(--divider-color);">Status</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${c}\n          </tbody>\n        </table>\n      </div>\n      <div style="margin-top:8px; font-size: 0.8em; color: var(--secondary-text-color);">\n        Flydata fra <a href="https://www.avinor.no/" target="_blank" rel="noreferrer">Avinor</a>\n      </div>\n    `}_e(t){if(null==t)return"";return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}_getAirportName(t){if(!t)return"";return{OSL:"Oslo",BGO:"Bergen",TRD:"Trondheim",SVG:"Stavanger",BOO:"Bodø",TOS:"Tromsø",AES:"Ålesund",KRS:"Kristiansand",HAU:"Haugesund",MOL:"Molde",EVE:"Harstad/Narvik",KKN:"Kirkenes",LKL:"Lakselv",ALF:"Alta",HFT:"Hammerfest",VDS:"Vadsø",BDU:"Bardufoss",SSJ:"Sandnessjøen",MJF:"Mosjøen",RVK:"Rørvik",BNN:"Brønnøysund",SKN:"Stokmarknes",LYR:"Longyearbyen",ANX:"Andøya",FDE:"Førde",SOG:"Sogndal",FRO:"Florø",NTB:"Notodden",SKE:"Skien",TRF:"Sandefjord",RRS:"Røros",OLA:"Ørland",HOV:"Ørsta-Volda",SDN:"Sandane",CPH:"Copenhagen",ARN:"Stockholm",HEL:"Helsinki",LHR:"London",AMS:"Amsterdam",CDG:"Paris",FRA:"Frankfurt",MUC:"Munich",ZRH:"Zurich",BCN:"Barcelona",MAD:"Madrid",FCO:"Rome",IST:"Istanbul",DXB:"Dubai",DOH:"Doha",JFK:"New York",EWR:"Newark",ORD:"Chicago",LAX:"Los Angeles",MIA:"Miami",BKK:"Bangkok",SIN:"Singapore",HKG:"Hong Kong",NRT:"Tokyo",ICN:"Seoul",KEF:"Reykjavik",ATH:"Athens",DUB:"Dublin",BRU:"Brussels",VIE:"Vienna",PRG:"Prague",WAW:"Warsaw",LIS:"Lisbon",MAN:"Manchester",EDI:"Edinburgh",GLA:"Glasgow",NCE:"Nice",LYS:"Lyon",TXL:"Berlin",HAM:"Hamburg",DUS:"Düsseldorf",BER:"Berlin",CGN:"Cologne",STR:"Stuttgart"}[t]||t}_getStatusText(t){if(!t)return"";return{E:"New Info",A:"Arrived",C:"Cancelled",D:"Departed",N:"New Time",BRD:"Boarding",GCL:"Gate Closed",GTD:"Gate Open",DLY:"Delayed",EXP:"Expected",FIR:"Final Call",WIL:"Wait in Lounge",DEP:"Departed",ARR:"Arrived",CNX:"Cancelled",AIR:"Airborne",LND:"Landed",CKI:"Check-in",CKC:"Check-in Closed"}[t]||t}_extractTime(t){if(!t)return"";try{const e=new Date(t+(t.includes("Z")?"":"Z"));if(isNaN(e.getTime()))return t;const n=e.getHours().toString().padStart(2,"0");return`${n}:${e.getMinutes().toString().padStart(2,"0")}`}catch(e){return t}}getCardSize(){return 4}}customElements.define("avinor-flight-card",t);class e extends HTMLElement{setConfig(t){this._config=t,this._rendered||this.render()}configChanged(t){const e=new Event("config-changed",{bubbles:!0,composed:!0});e.detail={config:t},this.dispatchEvent(e)}render(){if(!this._config)return;const t=(this._hass?Object.keys(this._hass.states).filter(t=>t.startsWith("sensor.avinor_")).sort():[]).map(t=>{const e=this._hass.states[t];return`<option value="${t}">${t} - ${e.attributes.airport||""} ${"D"===(e.attributes.direction||"")?"Departures":"Arrivals"}</option>`}).join("");this.innerHTML=`\n      <div style="padding: 16px;">\n        <div style="margin-bottom: 16px; position: relative;">\n          <label style="display: block; margin-bottom: 8px; font-weight: 500;">\n            Entity (required)\n          </label>\n          <select\n            id="entity"\n            style="width: 100%; padding: 8px; border: 1px solid var(--divider-color); border-radius: 4px; background: var(--card-background-color); color: var(--primary-text-color);"\n          >\n            <option value="">-- Select an entity --</option>\n            ${t}\n          </select>\n          <div style="margin-top: 4px; font-size: 0.9em; color: var(--secondary-text-color);">\n            Select an Avinor flight sensor entity\n          </div>\n        </div>\n\n        <div style="margin-bottom: 16px;">\n          <label style="display: block; margin-bottom: 8px; font-weight: 500;">\n            Title (optional)\n          </label>\n          <input\n            type="text"\n            id="title"\n            value="${this._config.title||""}"\n            placeholder="Avganger OSL"\n            style="width: 100%; padding: 8px; border: 1px solid var(--divider-color); border-radius: 4px; background: var(--card-background-color); color: var(--primary-text-color);"\n          />\n          <div style="margin-top: 4px; font-size: 0.9em; color: var(--secondary-text-color);">\n            Card title (leave empty for default)\n          </div>\n        </div>\n      </div>\n    `;const e=this.querySelector("#entity");this._config.entity&&(e.value=this._config.entity),e.addEventListener("change",t=>{this._config={...this._config,entity:t.target.value},this.configChanged(this._config)}),this.querySelector("#title").addEventListener("input",t=>{this._config={...this._config,title:t.target.value},this.configChanged(this._config)}),this._rendered=!0}set hass(t){this._hass=t}}customElements.define("avinor-flight-card-editor",e),console.info("%c AVINOR-FLIGHT-CARD %c Registered successfully with visual editor ","background-color: #41bdf5; color: #fff; font-weight: bold;","background-color: #333; color: #fff;");
